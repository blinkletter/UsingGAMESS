
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Data Workflow &#8212; Fun With GAMESS</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/tufte.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. Allyl Cation: π Orbitals" href="6_Pi_Orbitals.html" />
    <link rel="prev" title="GAMESS Workflow" href="5_Rotation_Profiles_Workflow.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/Solvent_plot3.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Fun With GAMESS</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="start.html">
   Fun With GAMESS
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="1_Setup.html">
   1. Building Your System
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="1A_Unix.html">
     Using Unix
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_SmallMolecules.html">
   2. Water: Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3_Visual_Input.html">
   3. Methane: Visual Input and Output
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4_Ethane.html">
   4. Ethane: Symmetry in Calculations
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="5_Rotation_Profiles.html">
   5. Butane: Rotation Energy Profiles
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="5_Rotation_Profiles_Workflow.html">
     <em>
      GAMESS
     </em>
     Workflow
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Data Workflow
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6_Pi_Orbitals.html">
   6. Allyl Cation: π Orbitals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6_Benzene.html">
   7. Benzene: MOs and Symmetry
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="7_Butadiene.html">
   8. Butadiene: Transition State for Rotation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="butadiene.inp.html">
     Butadiene.inp
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="butadiene.log.html">
     Butadiene.log
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="8A_Diels_Alder.html">
   9. Diels-Alder Reaction: Intrinsic Reaction Coordinates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="8_Reaction_Coord_Scan_Data.html">
     Data Workflow
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="9_Solvent.html">
   10. Solvent: The Environment Matters
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="10_Solvent_IRC_Plots.html">
     Data Cleaning Workflow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="10_Solvent_IRC_Plots-Data.html">
     Data Plotting Workflow
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/5_Rotation_Profiles_Workflow_Data.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/blinkletter/UsingGAMESS/master?urlpath=tree/docs/5_Rotation_Profiles_Workflow_Data.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-raw-data">
   Import Raw Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cleaning-the-data">
   Cleaning the Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#processing-the-data">
   Processing the Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-the-profile">
   Plotting the Profile
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#publication-quality">
   Publication Quality
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#saving-the-data">
   Saving the Data
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Data Workflow</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-raw-data">
   Import Raw Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cleaning-the-data">
   Cleaning the Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#processing-the-data">
   Processing the Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-the-profile">
   Plotting the Profile
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#publication-quality">
   Publication Quality
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#saving-the-data">
   Saving the Data
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="data-workflow">
<h1>Data Workflow<a class="headerlink" href="#data-workflow" title="Permalink to this headline">¶</a></h1>
<p>If you open the <code class="docutils literal notranslate"><span class="pre">butane_result.txt</span></code> file in a text editor you will see nineteen lines of data, one line for ezch file.</p>
<p>Within the file name is the torsion angle. The step number for the last energy calculation, NSERCH, is next. The energy follows that and the value is in units of Hartrees/molecule. We will want to convert that to kJ/mole. Then we have the energy gradient for the last structure of the optimization. It should be less than 0.0001 for the claulation to stop. We could have set this lower or higher. The last value recorded in each line is the RMS deviation for the gradient calculation.</p>
<p><strong>butane_result.txt</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_000_303</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span>  <span class="mi">23</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4228465418</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000585</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000204</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_010_304</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span>  <span class="mi">18</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4233726910</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000931</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000255</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_020_305</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span>  <span class="mi">16</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4247889225</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000789</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000273</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_030_306</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span>  <span class="mi">16</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4267021853</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000394</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000149</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_040_307</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span>  <span class="mi">19</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4286426893</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000765</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000260</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_050_308</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span>  <span class="mi">18</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4301847220</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000241</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000105</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_060_309</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span>  <span class="mi">23</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4310615763</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000675</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000212</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_070_310</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span>  <span class="mi">25</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4312168483</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000339</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000129</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_080_311</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span>  <span class="mi">24</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4306888649</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000987</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000300</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_090_312</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span>  <span class="mi">26</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4295739060</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000494</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000155</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_100_313</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span> <span class="mi">390</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4282209688</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000578</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000160</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_110_314</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span>  <span class="mi">23</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4271414620</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000819</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000247</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_120_315</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span>  <span class="mi">24</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4267263463</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000884</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000234</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_130_316</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span> <span class="mi">362</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4271134870</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000551</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000145</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_140_317</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span>  <span class="mi">21</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4281850977</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000701</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000323</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_150_318</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span>  <span class="mi">21</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4296331216</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000712</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000225</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_160_319</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span> <span class="mi">646</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4310600533</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000567</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000254</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_170_320</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span>  <span class="mi">20</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4320918106</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000675</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000216</span>
<span class="n">butane_SCAN</span><span class="o">.</span><span class="n">inp_180_321</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="n">NSERCH</span><span class="p">:</span>  <span class="mi">23</span>  <span class="n">E</span><span class="o">=</span>     <span class="o">-</span><span class="mf">156.4324667182</span>  <span class="n">GRAD</span><span class="o">.</span> <span class="n">MAX</span><span class="o">=</span>  <span class="mf">0.0000605</span>  <span class="n">R</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">S</span><span class="o">.=</span>  <span class="mf">0.0000189</span>
</pre></div>
</div>
<p>Observe that three of the jobs took a longer time to converge. We could open them in MacMolPlt and watch a “movie” of their journey and plot the energies along the way. Where did they get stuck? All three eventually found their way home, but only because this was a light-weight theory level and I was confidient in allowing for a large number of steps. If the level of theory was higher I might hav set the limit to 100 steps, or even 30 steps. All other jobs converged in less than 30 steps.</p>
<p>Why did these three take so long? Bad luck with the exact structure of the input started them on the long path. Tweak a few bond lengths or angles and they might converge just like the others. Clearly, how you start matters. For high levels of theory it is important to start as close to the final answer as possible.</p>
<div class="section" id="import-raw-data">
<h2>Import Raw Data<a class="headerlink" href="#import-raw-data" title="Permalink to this headline">¶</a></h2>
<p>We could edit the data in a text editor but we will do everything using the data analysis tools of Python and pandas. First we will import the data as a dataframe using pandas. The datafile must be in the same directory as this workbook, or you must specify the file path. Don’t worry, python will scream at you if you make a mistake and you will be able to fix any problems.</p>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">pandas.read_csv()</span></code> function to read the file and create a dataframe object. The <code class="docutils literal notranslate"><span class="pre">header</span> <span class="pre">=</span> <span class="pre">None</span></code> setting prevents the first line from being used to label the columns. The <code class="docutils literal notranslate"><span class="pre">sep</span> <span class="pre">=</span> <span class="pre">r&quot;\s+|_&quot;</span></code> establishes that one or more spaces separates columns and also the <code class="docutils literal notranslate"><span class="pre">_</span></code> character separates columns. The <code class="docutils literal notranslate"><span class="pre">engine</span> <span class="pre">=</span> <span class="pre">&quot;python&quot;</span></code> means to use the python engine rather than the default cpython engine. The cpython engine is much faster, but it is not compatible with the way I am using the <code class="docutils literal notranslate"><span class="pre">sep</span></code> parameter. How do I know this? I got an error message that told me what to do.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;butane_result.txt&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\s+|_&quot;</span><span class="p">,</span> <span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;python&quot;</span><span class="p">)</span> 
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>butane</td>
      <td>SCAN.inp</td>
      <td>0</td>
      <td>303.log:</td>
      <td>NSERCH:</td>
      <td>23</td>
      <td>E=</td>
      <td>-156.422847</td>
      <td>GRAD.</td>
      <td>MAX=</td>
      <td>0.000058</td>
      <td>R.M.S.=</td>
      <td>0.000020</td>
    </tr>
    <tr>
      <th>1</th>
      <td>butane</td>
      <td>SCAN.inp</td>
      <td>10</td>
      <td>304.log:</td>
      <td>NSERCH:</td>
      <td>18</td>
      <td>E=</td>
      <td>-156.423373</td>
      <td>GRAD.</td>
      <td>MAX=</td>
      <td>0.000093</td>
      <td>R.M.S.=</td>
      <td>0.000025</td>
    </tr>
    <tr>
      <th>2</th>
      <td>butane</td>
      <td>SCAN.inp</td>
      <td>20</td>
      <td>305.log:</td>
      <td>NSERCH:</td>
      <td>16</td>
      <td>E=</td>
      <td>-156.424789</td>
      <td>GRAD.</td>
      <td>MAX=</td>
      <td>0.000079</td>
      <td>R.M.S.=</td>
      <td>0.000027</td>
    </tr>
    <tr>
      <th>3</th>
      <td>butane</td>
      <td>SCAN.inp</td>
      <td>30</td>
      <td>306.log:</td>
      <td>NSERCH:</td>
      <td>16</td>
      <td>E=</td>
      <td>-156.426702</td>
      <td>GRAD.</td>
      <td>MAX=</td>
      <td>0.000039</td>
      <td>R.M.S.=</td>
      <td>0.000015</td>
    </tr>
    <tr>
      <th>4</th>
      <td>butane</td>
      <td>SCAN.inp</td>
      <td>40</td>
      <td>307.log:</td>
      <td>NSERCH:</td>
      <td>19</td>
      <td>E=</td>
      <td>-156.428643</td>
      <td>GRAD.</td>
      <td>MAX=</td>
      <td>0.000077</td>
      <td>R.M.S.=</td>
      <td>0.000026</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="cleaning-the-data">
<h2>Cleaning the Data<a class="headerlink" href="#cleaning-the-data" title="Permalink to this headline">¶</a></h2>
<p>Data cleaning is half the work in data analysis. We need to drop empty records and malformed records (each line could be considered a record in this case). We will need to drop any fields (the columns in eacxh record are the fields). Inspecting the dataframe shows me that I only need columns 2,5,7 and 10. We will rename the columns for what they represent. inspect the orginal dataframe above to see where I got my lables from.</p>
<p>In the code below I create a new dataframe by selecting the four chosen columns out of the previous dataframe. Then I renamed the column headres from numbers to labels so I don’t forget what they are.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">butane</span> <span class="o">=</span> <span class="n">df</span><span class="p">[:][[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">]]</span>
<span class="n">butane</span> <span class="o">=</span> <span class="n">butane</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span><span class="s1">&#39;Torsion&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span><span class="s1">&#39;NSERCH&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="s1">&#39;Energy&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span><span class="s1">&#39;GRAD&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">butane</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Torsion</th>
      <th>NSERCH</th>
      <th>Energy</th>
      <th>GRAD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>23</td>
      <td>-156.422847</td>
      <td>0.000058</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>18</td>
      <td>-156.423373</td>
      <td>0.000093</td>
    </tr>
    <tr>
      <th>2</th>
      <td>20</td>
      <td>16</td>
      <td>-156.424789</td>
      <td>0.000079</td>
    </tr>
    <tr>
      <th>3</th>
      <td>30</td>
      <td>16</td>
      <td>-156.426702</td>
      <td>0.000039</td>
    </tr>
    <tr>
      <th>4</th>
      <td>40</td>
      <td>19</td>
      <td>-156.428643</td>
      <td>0.000077</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="processing-the-data">
<h2>Processing the Data<a class="headerlink" href="#processing-the-data" title="Permalink to this headline">¶</a></h2>
<p>We now have a cleaned up data set. We could have done all of this in Excel by importing the text file, setting column breaks manually, deleting unwanted columns manually and then typing in names for the columns. Python and pandas may seem like a bit of work but it is not any more than you would do setting up the data in Excel.</p>
<p>We know that a Hartree is <span class="math notranslate nohighlight">\(2625.7\, kJ/mole\)</span>. So we can convert the energy to a more familiar unit. Then we should set our lowest energy structure as the zero referemce and substract that value from all the energies to establish a relative scale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">hartree_conversion</span> <span class="o">=</span> <span class="mf">2625.7</span>

<span class="n">lowest_energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">butane</span><span class="p">[:][</span><span class="s2">&quot;Energy&quot;</span><span class="p">])</span>
<span class="n">butane</span><span class="p">[</span><span class="s2">&quot;DeltaE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">butane</span><span class="p">[:][</span><span class="s2">&quot;Energy&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">lowest_energy</span><span class="p">)</span> <span class="o">*</span> <span class="n">hartree_conversion</span>
<span class="n">display</span><span class="p">(</span><span class="n">butane</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Torsion</th>
      <th>NSERCH</th>
      <th>Energy</th>
      <th>GRAD</th>
      <th>DeltaE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>23</td>
      <td>-156.422847</td>
      <td>0.000058</td>
      <td>25.259697</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>18</td>
      <td>-156.423373</td>
      <td>0.000093</td>
      <td>23.878187</td>
    </tr>
    <tr>
      <th>2</th>
      <td>20</td>
      <td>16</td>
      <td>-156.424789</td>
      <td>0.000079</td>
      <td>20.159588</td>
    </tr>
    <tr>
      <th>3</th>
      <td>30</td>
      <td>16</td>
      <td>-156.426702</td>
      <td>0.000039</td>
      <td>15.135934</td>
    </tr>
    <tr>
      <th>4</th>
      <td>40</td>
      <td>19</td>
      <td>-156.428643</td>
      <td>0.000077</td>
      <td>10.040753</td>
    </tr>
    <tr>
      <th>5</th>
      <td>50</td>
      <td>18</td>
      <td>-156.430185</td>
      <td>0.000024</td>
      <td>5.991837</td>
    </tr>
    <tr>
      <th>6</th>
      <td>60</td>
      <td>23</td>
      <td>-156.431062</td>
      <td>0.000068</td>
      <td>3.689481</td>
    </tr>
    <tr>
      <th>7</th>
      <td>70</td>
      <td>25</td>
      <td>-156.431217</td>
      <td>0.000034</td>
      <td>3.281783</td>
    </tr>
    <tr>
      <th>8</th>
      <td>80</td>
      <td>24</td>
      <td>-156.430689</td>
      <td>0.000099</td>
      <td>4.668109</td>
    </tr>
    <tr>
      <th>9</th>
      <td>90</td>
      <td>26</td>
      <td>-156.429574</td>
      <td>0.000049</td>
      <td>7.595657</td>
    </tr>
    <tr>
      <th>10</th>
      <td>100</td>
      <td>390</td>
      <td>-156.428221</td>
      <td>0.000058</td>
      <td>11.148064</td>
    </tr>
    <tr>
      <th>11</th>
      <td>110</td>
      <td>23</td>
      <td>-156.427141</td>
      <td>0.000082</td>
      <td>13.982525</td>
    </tr>
    <tr>
      <th>12</th>
      <td>120</td>
      <td>24</td>
      <td>-156.426726</td>
      <td>0.000088</td>
      <td>15.072494</td>
    </tr>
    <tr>
      <th>13</th>
      <td>130</td>
      <td>362</td>
      <td>-156.427113</td>
      <td>0.000055</td>
      <td>14.055979</td>
    </tr>
    <tr>
      <th>14</th>
      <td>140</td>
      <td>21</td>
      <td>-156.428185</td>
      <td>0.000070</td>
      <td>11.242251</td>
    </tr>
    <tr>
      <th>15</th>
      <td>150</td>
      <td>21</td>
      <td>-156.429633</td>
      <td>0.000071</td>
      <td>7.440175</td>
    </tr>
    <tr>
      <th>16</th>
      <td>160</td>
      <td>646</td>
      <td>-156.431060</td>
      <td>0.000057</td>
      <td>3.693480</td>
    </tr>
    <tr>
      <th>17</th>
      <td>170</td>
      <td>20</td>
      <td>-156.432092</td>
      <td>0.000068</td>
      <td>0.984395</td>
    </tr>
    <tr>
      <th>18</th>
      <td>180</td>
      <td>23</td>
      <td>-156.432467</td>
      <td>0.000061</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="plotting-the-profile">
<h2>Plotting the Profile<a class="headerlink" href="#plotting-the-profile" title="Permalink to this headline">¶</a></h2>
<p>Now we have a set of data that we can plot. Let us visualize the profile using the MatPlotLib library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">butane</span><span class="p">[:][</span><span class="s2">&quot;Torsion&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">butane</span><span class="p">[:][</span><span class="s2">&quot;DeltaE&quot;</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="s2">&quot;ko-&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Rotation_Profiles_Workflow_Data_10_0.png" src="_images/5_Rotation_Profiles_Workflow_Data_10_0.png" />
</div>
</div>
</div>
<div class="section" id="publication-quality">
<h2>Publication Quality<a class="headerlink" href="#publication-quality" title="Permalink to this headline">¶</a></h2>
<p>We can be more stylish. I will use the stylesheet that I editted to my preference. It must be in the local directory.</p>
<p>Divverent journals have different standards for plots. Just follow their instructions. many will hae stylesheets available for your word processor, for <span class="math notranslate nohighlight">\(\LaTeX\)</span> and  even for MacMolPlt. use the <code class="docutils literal notranslate"><span class="pre">savefig()</span></code> method of the <code class="docutils literal notranslate"><span class="pre">fig</span></code> object to save the plot as a file. The <code class="docutils literal notranslate"><span class="pre">.pdf</span></code> extension will tell it to save in PDF format.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">butane</span><span class="p">[:][</span><span class="s2">&quot;Torsion&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">butane</span><span class="p">[:][</span><span class="s2">&quot;DeltaE&quot;</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;S2_classic2.mplstyle&quot;</span><span class="p">)</span>        
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s2">&quot;o-&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Butane Torsional Energy profile&quot;</span><span class="p">,</span>       
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Energy $\left(\frac</span><span class="si">{kJ}{mole}</span><span class="s2">\right)$&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Angle&quot;</span><span class="p">,</span>                
          <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">180</span><span class="p">],</span>                  
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">]</span>
      <span class="p">)</span>                   

<span class="c1">#fig.savefig(&quot;plot.pdf&quot;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Rotation_Profiles_Workflow_Data_12_0.png" src="_images/5_Rotation_Profiles_Workflow_Data_12_0.png" />
</div>
</div>
<p>The plot above is a “connect-the-dots” style plot.  There are many data points and it looks fine. We do not have an exact function to which to fit the data but we could apply the infamous “cubic spline.” We will use the <code class="docutils literal notranslate"><span class="pre">CubicSpline</span></code> function available from the <code class="docutils literal notranslate"><span class="pre">scipy.interpolate</span></code> library (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.CubicSpline.html">Documentation</a>) to generate a function that represents the curve fit.  We will then feed an x-axis of many data points into that function to create a x,y data set that represents that curve fit as a smooth line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">CubicSpline</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;S2_classic2.mplstyle&quot;</span><span class="p">)</span>        
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  

<span class="n">cs</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">cs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">butane</span><span class="p">[:][</span><span class="s2">&quot;Torsion&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">butane</span><span class="p">[:][</span><span class="s2">&quot;DeltaE&quot;</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Butane Torsional Energy profile&quot;</span><span class="p">,</span>       
          <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Energy $\left(\frac</span><span class="si">{kJ}{mole}</span><span class="s2">\right)$&quot;</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Angle&quot;</span><span class="p">,</span>                
          <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">180</span><span class="p">],</span>                  
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">]</span>
      <span class="p">)</span>                   

<span class="c1">#fig.savefig(&quot;plot.pdf&quot;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5_Rotation_Profiles_Workflow_Data_14_0.png" src="_images/5_Rotation_Profiles_Workflow_Data_14_0.png" />
</div>
</div>
</div>
<div class="section" id="saving-the-data">
<h2>Saving the Data<a class="headerlink" href="#saving-the-data" title="Permalink to this headline">¶</a></h2>
<p>We have imported, cleaned and processed the data. maybe we should save our work so we can use this data set directly and easily next time.  The dataframe object contains methods to do this. We will use the ‘pandas.DataFrame.to_csv()’ method(<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_csv.html">documentation</a>) to save the dataframe object as a csv text file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">butane</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;butane_profile.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The butane energy profile data is now saved in a file named butane_profile.csv. below the file is reporduced in csv format.</p>
<p><strong>butane_profile.csv</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">,</span><span class="n">Torsion</span><span class="p">,</span><span class="n">NSERCH</span><span class="p">,</span><span class="n">Energy</span><span class="p">,</span><span class="n">GRAD</span><span class="p">,</span><span class="n">DeltaE</span>
<span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="o">-</span><span class="mf">156.4228465418</span><span class="p">,</span><span class="mf">5.85e-05</span><span class="p">,</span><span class="mf">25.2596971734949</span>
<span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="o">-</span><span class="mf">156.423372691</span><span class="p">,</span><span class="mf">9.31e-05</span><span class="p">,</span><span class="mf">23.87818721905798</span>
<span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="o">-</span><span class="mf">156.4247889225</span><span class="p">,</span><span class="mf">7.89e-05</span><span class="p">,</span><span class="mf">20.15958816950236</span>
<span class="mi">3</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="o">-</span><span class="mf">156.4267021853</span><span class="p">,</span><span class="mf">3.94e-05</span><span class="p">,</span><span class="mf">15.135934035536433</span>
<span class="mi">4</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="o">-</span><span class="mf">156.4286426893</span><span class="p">,</span><span class="mf">7.65e-05</span><span class="p">,</span><span class="mf">10.040752682726497</span>
<span class="mi">5</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="o">-</span><span class="mf">156.430184722</span><span class="p">,</span><span class="mf">2.41e-05</span><span class="p">,</span><span class="mf">5.991837422332486</span>
<span class="mi">6</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="o">-</span><span class="mf">156.4310615763</span><span class="p">,</span><span class="mf">6.75e-05</span><span class="p">,</span><span class="mf">3.68948108681445</span>
<span class="mi">7</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="o">-</span><span class="mf">156.4312168483</span><span class="p">,</span><span class="mf">3.39e-05</span><span class="p">,</span><span class="mf">3.281783396412743</span>
<span class="mi">8</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="o">-</span><span class="mf">156.4306888649</span><span class="p">,</span><span class="mf">9.87e-05</span><span class="p">,</span><span class="mf">4.6681094098429945</span>
<span class="mi">9</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="o">-</span><span class="mf">156.429573906</span><span class="p">,</span><span class="mf">4.94e-05</span><span class="p">,</span><span class="mf">7.595656993546515</span>
<span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">390</span><span class="p">,</span><span class="o">-</span><span class="mf">156.4282209688</span><span class="p">,</span><span class="mf">5.78e-05</span><span class="p">,</span><span class="mf">11.148064199614685</span>
<span class="mi">11</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="o">-</span><span class="mf">156.427141462</span><span class="p">,</span><span class="mf">8.19e-05</span><span class="p">,</span><span class="mf">13.982525204328091</span>
<span class="mi">12</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="o">-</span><span class="mf">156.4267263463</span><span class="p">,</span><span class="mf">8.84e-05</span><span class="p">,</span><span class="mf">15.072494497839289</span>
<span class="mi">13</span><span class="p">,</span><span class="mi">130</span><span class="p">,</span><span class="mi">362</span><span class="p">,</span><span class="o">-</span><span class="mf">156.427113487</span><span class="p">,</span><span class="mf">5.51e-05</span><span class="p">,</span><span class="mf">14.05597916181428</span>
<span class="mi">14</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="o">-</span><span class="mf">156.4281850977</span><span class="p">,</span><span class="mf">7.01e-05</span><span class="p">,</span><span class="mf">11.242250946837245</span>
<span class="mi">15</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="o">-</span><span class="mf">156.4296331216</span><span class="p">,</span><span class="mf">7.12e-05</span><span class="p">,</span><span class="mf">7.440174592616324</span>
<span class="mi">16</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="mi">646</span><span class="p">,</span><span class="o">-</span><span class="mf">156.4310600533</span><span class="p">,</span><span class="mf">5.67e-05</span><span class="p">,</span><span class="mf">3.693480027937488</span>
<span class="mi">17</span><span class="p">,</span><span class="mi">170</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="o">-</span><span class="mf">156.4320918106</span><span class="p">,</span><span class="mf">6.75e-05</span><span class="p">,</span><span class="mf">0.9843948852952991</span>
<span class="mi">18</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="o">-</span><span class="mf">156.4324667182</span><span class="p">,</span><span class="mf">6.05e-05</span><span class="p">,</span><span class="mf">0.0</span>
</pre></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="5_Rotation_Profiles_Workflow.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><em>GAMESS</em> Workflow</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="6_Pi_Orbitals.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">6. Allyl Cation: π Orbitals</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Barry Linkletter<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>